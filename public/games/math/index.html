<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Math Sprint – Single File</title>
<style>
  :root { --bg:#0b0f15; --panel:#121826; --text:#e7ecf3; --muted:#9fb0c8; --accent:#3ea6ff; }
  *{ box-sizing:border-box }
  html,body{ height:100% }
  body{
    margin:0;font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,"Helvetica Neue",Arial;
    background: radial-gradient(1200px 800px at 70% -10%, #152033 0%, var(--bg) 60%);
    color:var(--text); display:grid; place-items:center;
  }
  .wrap{ display:grid; grid-template-columns:minmax(320px,680px) 280px; gap:18px; align-items:start; padding:16px; width:100%; max-width:1100px }
  .panel{ background:linear-gradient(180deg,#0f1524 0%,var(--panel) 100%); border:1px solid #1e2a44; border-radius:16px; padding:14px; box-shadow:0 10px 30px rgba(0,0,0,.35) }
  h1{ margin:0 0 4px; font-size:22px; font-weight:800; letter-spacing:.4px }
  h2{ margin:0 0 8px; font-size:14px; font-weight:800; letter-spacing:.4px; color:var(--muted); text-transform:uppercase }
  .sub{ color:var(--muted); font-size:12px }
  .stats{ display:grid; grid-template-columns:1fr auto; gap:8px 12px; font-weight:600; margin-bottom:8px }
  .stats div:nth-child(odd){ color:var(--muted); font-weight:500 }
  .btnrow{ display:flex; gap:8px; flex-wrap:wrap; margin-top:8px }
  button{ cursor:pointer; background:var(--accent); color:#09121f; font-weight:800; border:0; padding:10px 12px; border-radius:12px; box-shadow:0 6px 16px rgba(62,166,255,.35) }
  button.secondary{ background:#24324d; color:var(--text); box-shadow:none; border:1px solid #2d3d61 }
  .main{ padding:18px }
  .problemBox{ margin-top:8px }
  #problem{ font-size:clamp(28px,5vw,56px); text-align:center; margin:22px 0; letter-spacing:.5px }
  .answerRow{ display:flex; gap:8px; justify-content:center }
  #answer{ width:220px; padding:12px 14px; border-radius:12px; border:1px solid #223253; background:#0b1222; color:var(--text); font-size:18px; text-align:center }
  #answer:focus{ outline:2px solid #2f65ff44 }
  .feedback{ text-align:center; min-height:20px; margin-top:8px; font-weight:700 }
  .feedback.ok{ color:#83e07c } .feedback.bad{ color:#ff8a8a }
  .settings{ display:grid; gap:10px } .settings .row{ display:grid; grid-template-columns:90px 1fr; gap:10px; align-items:center }
  .settings .label{ color:var(--muted); font-size:12px; font-weight:700; text-transform:uppercase; letter-spacing:.6px }
  .ops{ display:flex; gap:10px; flex-wrap:wrap }
  .legend{ font-size:12px; color:var(--muted); line-height:1.4 }
  .aside{ display:grid; gap:12px }
  .mobile{ display:none }
  @media (max-width:900px){ .wrap{ grid-template-columns:1fr } .mobile{ display:block } }
  .numpad{ display:grid; grid-template-columns:repeat(3,1fr); gap:8px; margin-top:10px }
  .numpad button{ background:#16233c; color:#cfe0ff; border:1px solid #2a3c60; box-shadow:none; border-radius:12px; padding:14px; font-weight:800 }
  .numpad button.primary{ background:var(--accent); color:#09121f }
  .numpad button.wide{ grid-column:span 2 }
  .credit{ text-align:center; font-size:12px; color:#88a1c6; margin-top:6px }
  .overlay{ position:fixed; inset:0; display:grid; place-items:center; background:rgba(0,0,0,.5) }
  .overlay[hidden]{ display:none }
  .modal .summary{ display:grid; gap:6px; font-size:14px }
</style>
</head>
<body>
  <div class="wrap">
    <div class="panel main">
      <div class="header">
        <h1>Math Sprint</h1>
        <div class="sub">Fast mental arithmetic • beat the clock</div>
      </div>
      <div class="problemBox">
        <div id="problem" aria-live="polite">Press Start</div>
        <div class="answerRow">
          <input id="answer" type="text" inputmode="numeric" autocomplete="off" placeholder="Your answer…" />
          <button id="btnSubmit" class="primary">Enter</button>
        </div>
        <div id="feedback" class="feedback" aria-live="polite"></div>
      </div>
      <div class="mobile">
        <div class="numpad">
          <button data-k="7">7</button><button data-k="8">8</button><button data-k="9">9</button>
          <button data-k="4">4</button><button data-k="5">5</button><button data-k="6">6</button>
          <button data-k="1">1</button><button data-k="2">2</button><button data-k="3">3</button>
          <button data-k="0" class="wide">0</button><button data-k="bk">⌫</button>
          <button data-k="ok" class="primary wide">OK</button>
        </div>
        <div class="credit">Tip: you can also type and press Enter</div>
      </div>
    </div>
    <div class="aside">
      <div class="panel">
        <h2>Stats</h2>
        <div class="stats">
          <div>Score</div><div id="statScore">0</div>
          <div>Streak</div><div id="statStreak">0</div>
          <div>Accuracy</div><div id="statAcc">0%</div>
          <div>Correct</div><div id="statGood">0</div>
          <div>Wrong</div><div id="statBad">0</div>
          <div>Time</div><div id="statTime">00:00</div>
        </div>
        <div class="btnrow">
          <button id="btnStart">Start / Restart</button>
          <button id="btnPause" class="secondary">Pause</button>
        </div>
      </div>
      <div class="panel">
        <h2>Settings</h2>
        <div class="settings">
          <div class="row">
            <div class="label">Operations</div>
            <div class="ops">
              <label><input type="checkbox" id="opAdd" checked> +</label>
              <label><input type="checkbox" id="opSub" checked> −</label>
              <label><input type="checkbox" id="opMul"> ×</label>
              <label><input type="checkbox" id="opDiv"> ÷</label>
            </div>
          </div>
          <div class="row">
            <div class="label">Difficulty</div>
            <select id="difficulty">
              <option value="easy">Easy (0–10)</option>
              <option value="normal" selected>Normal (0–20)</option>
              <option value="hard">Hard (0–99)</option>
            </select>
          </div>
          <div class="row">
            <div class="label">Mode</div>
            <select id="mode">
              <option value="sprint" selected>Sprint (timed)</option>
              <option value="practice">Practice (no timer)</option>
            </select>
          </div>
          <div class="row" id="timeRow">
            <div class="label">Time</div>
            <select id="timeSelect">
              <option value="30">30s</option>
              <option value="60" selected>60s</option>
              <option value="120">120s</option>
            </select>
          </div>
        </div>
      </div>
      <div class="panel legend">
        <div><strong>How to play</strong></div>
        <div>Solve as many correct answers as possible.</div>
        <div>Enter to submit • Esc to clear • P to pause.</div>
        <div>Division uses only whole-number results.</div>
      </div>
    </div>
  </div>

  <div id="overlay" class="overlay" hidden>
    <div class="modal panel">
      <h2>Time!</h2>
      <div class="summary">
        <div><b>Score:</b> <span id="sumScore">0</span></div>
        <div><b>Accuracy:</b> <span id="sumAcc">0%</span></div>
        <div><b>Correct:</b> <span id="sumGood">0</span> • <b>Wrong:</b> <span id="sumBad">0</span></div>
      </div>
      <div class="btnrow">
        <button id="btnAgain">Play again</button>
        <button id="btnClose" class="secondary">Close</button>
      </div>
    </div>
  </div>

<script>
(() => {
  let timer = null, timeLeft = 0, running = false, paused = false;
  let score = 0, streak = 0, correct = 0, wrong = 0, total = 0;
  let currentAnswer = null;
  const history = [];

  const elProblem = document.getElementById('problem');
  const elAnswer = document.getElementById('answer');
  const elFeedback = document.getElementById('feedback');
  const elSubmit = document.getElementById('btnSubmit');

  const elScore = document.getElementById('statScore');
  const elStreak = document.getElementById('statStreak');
  const elAcc = document.getElementById('statAcc');
  const elGood = document.getElementById('statGood');
  const elBad = document.getElementById('statBad');
  const elTime = document.getElementById('statTime');

  const btnStart = document.getElementById('btnStart');
  const btnPause = document.getElementById('btnPause');

  const opAdd = document.getElementById('opAdd');
  const opSub = document.getElementById('opSub');
  const opMul = document.getElementById('opMul');
  const opDiv = document.getElementById('opDiv');
  const selDiff = document.getElementById('difficulty');
  const selMode = document.getElementById('mode');
  const rowTime = document.getElementById('timeRow');
  const selTime = document.getElementById('timeSelect');

  const overlay = document.getElementById('overlay');
  const sumScore = document.getElementById('sumScore');
  const sumAcc = document.getElementById('sumAcc');
  const sumGood = document.getElementById('sumGood');
  const sumBad = document.getElementById('sumBad');
  const btnAgain = document.getElementById('btnAgain');
  const btnClose = document.getElementById('btnClose');

  const clamp = (n,a,b)=>Math.max(a,Math.min(b,n));
  function fmtTime(s){ s=Math.max(0,Math.floor(s)); const m=Math.floor(s/60); const r=s%60; return String(m).padStart(2,'0')+':'+String(r).padStart(2,'0'); }
  const updateStats = () => {
    elScore.textContent = String(score);
    elStreak.textContent = String(streak);
    const acc = total ? Math.round((correct/total)*100) : 0;
    elAcc.textContent = acc + '%';
    elGood.textContent = String(correct);
    elBad.textContent = String(wrong);
    elTime.textContent = fmtTime(timeLeft);
  };

  function rng(max){ return Math.floor(Math.random()*(max+1)); }
  function boundsForDifficulty(){
    switch(selDiff.value){
      case 'easy': return [0,10];
      case 'normal': return [0,20];
      case 'hard': return [0,99];
      default: return [0,20];
    }
  }
  function pickOps(){
    const ops=[];
    if(opAdd.checked) ops.push('+');
    if(opSub.checked) ops.push('-');
    if(opMul.checked) ops.push('×');
    if(opDiv.checked) ops.push('÷');
    if(ops.length===0) ops.push('+');
    return ops;
  }
  function genAddSub(a,b,op){ return { expr: a+' '+op+' '+b, ans: op==='+'?a+b:a-b }; }
  function genMul(a,b){ return { expr: a+' × '+b, ans: a*b }; }
  function genDiv(){
    const [lo,hi]=boundsForDifficulty();
    const divisor = clamp(rng(Math.max(2,hi)),2,Math.max(2,hi));
    const quotient = clamp(rng(Math.max(2,hi)),2,Math.max(2,hi));
    const dividend = divisor*quotient;
    return { expr: dividend+' ÷ '+divisor, ans: quotient };
  }
  function nextProblem(){
    const ops = pickOps();
    const op = ops[Math.floor(Math.random()*ops.length)];
    const [lo,hi]=boundsForDifficulty();
    let a=rng(hi), b=rng(hi);
    if(op==='-' && b>a){ const t=a; a=b; b=t; }
    let p;
    if(op==='+') p=genAddSub(a,b,'+');
    else if(op==='-') p=genAddSub(a,b,'-');
    else if(op==='×') p=genMul(a,b);
    else p=genDiv();
    currentAnswer = p.ans;
    elProblem.textContent = p.expr;
    elFeedback.textContent = '';
    elFeedback.className = 'feedback';
    elAnswer.value='';
    elAnswer.focus();
  }
  function applyCorrect(){
    streak+=1;
    const mult = 1 + Math.floor(streak/5)*0.25;
    const base = 10;
    score += Math.round(base*mult);
    correct+=1; total+=1;
    elFeedback.textContent = '✓ +' + Math.round(base*mult);
    elFeedback.className = 'feedback ok';
    updateStats(); nextProblem();
  }
  function applyWrong(){
    streak=0; wrong+=1; total+=1;
    score=Math.max(0,score-2);
    elFeedback.textContent = '✗ -2';
    elFeedback.className = 'feedback bad';
    updateStats(); nextProblem();
  }
  function submitAnswer(){
    if(!running||paused) return;
    const val = elAnswer.value.trim(); if(val==='') return;
    const user = Number(val);
    history.push({ q: elProblem.textContent, a: currentAnswer, u: user, ok: user===currentAnswer });
    if(user===currentAnswer) applyCorrect(); else applyWrong();
  }
  function startTimer(){
    if(selMode.value==='practice'){ timeLeft=0; updateStats(); return; }
    timeLeft = Number(selTime.value)||60; updateStats();
    clearInterval(timer);
    timer=setInterval(()=>{
      if(!running||paused) return;
      timeLeft-=1; updateStats();
      if(timeLeft<=0){ clearInterval(timer); finish(); }
    },1000);
  }
  function start(){
    running=true; paused=false;
    score=0; streak=0; correct=0; wrong=0; total=0; history.length=0;
    updateStats(); startTimer(); nextProblem();
  }
  function finish(){
    running=false; paused=false;
    const acc = total?Math.round((correct/total)*100):0;
    sumScore.textContent=String(score);
    sumAcc.textContent=acc+'%';
    sumGood.textContent=String(correct);
    sumBad.textContent=String(wrong);
    overlay.hidden=false;
  }
  function pauseToggle(){ if(!running) return; paused=!paused; if(!paused) elAnswer.focus(); }

  document.getElementById('btnStart').addEventListener('click',()=>{ overlay.hidden=true; start(); });
  document.getElementById('btnPause').addEventListener('click',pauseToggle);
  elSubmit.addEventListener('click',submitAnswer);
  elAnswer.addEventListener('keydown',(e)=>{ if(e.key==='Enter') submitAnswer(); else if(e.key==='Escape') elAnswer.value=''; });
  function syncTimeRow(){ document.getElementById('timeRow').style.display = selMode.value==='sprint'?'grid':'none'; }
  document.getElementById('mode').addEventListener('change',syncTimeRow); syncTimeRow();
  document.querySelectorAll('.numpad button').forEach(btn=>{
    btn.addEventListener('click',()=>{
      const k=btn.getAttribute('data-k');
      if(k==='ok') submitAnswer();
      else if(k==='bk') elAnswer.value = elAnswer.value.slice(0,-1);
      else elAnswer.value += k;
      elAnswer.focus();
    });
  });
  document.addEventListener('keydown',(e)=>{ if(e.key.toLowerCase()==='p') pauseToggle(); });
  document.getElementById('btnAgain').addEventListener('click',()=>{ overlay.hidden=true; start(); });
  document.getElementById('btnClose').addEventListener('click',()=>{ overlay.hidden=true; });
  updateStats();
})();
</script>
</body>
</html>
